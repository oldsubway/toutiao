{"version":3,"file":"js/296.0ac13162.js","mappings":"0JAAA,IAAIA,EAAS,WAAkB,IAAIC,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAOA,EAAG,MAAM,CAACE,YAAY,2BAA2B,CAACF,EAAG,cAAc,CAACG,MAAM,CAAC,MAAQ,OAAO,aAAa,GAAG,MAAQ,IAAIC,GAAG,CAAC,aAAa,SAASC,GAAQ,OAAOP,EAAIQ,QAAQC,MAAM,KAAKP,EAAG,WAAW,CAACG,MAAM,CAAC,SAAWL,EAAIU,SAAS,gBAAgB,QAAQ,mBAAkB,GAAOJ,GAAG,CAAC,KAAON,EAAIW,QAAQC,MAAM,CAACC,MAAOb,EAAIc,QAASC,SAAS,SAAUC,GAAMhB,EAAIc,QAAQE,CAAG,EAAEC,WAAW,YAAYjB,EAAIkB,GAAIlB,EAAImB,YAAY,SAASC,GAAM,OAAOlB,EAAG,WAAW,CAACmB,IAAID,EAAKE,OAAOjB,MAAM,CAAC,QAAUe,EAAK,WAAY,IAAQ,IAAG,IAAI,EACzkB,EACIG,EAAkB,G,oBCUtB,GACAC,KAAAA,eACAC,WAAAA,CACAC,QAAAA,EAAAA,GAEAC,MAAAA,CAAAA,MACAC,OACA,OACAT,WAAAA,GACAL,SAAAA,EACAJ,UAAAA,EACAmB,KAAAA,EAEA,EACAC,MAAAA,CACAC,KAEA,YACA,mBACA,gBACA,iBAEA,qBACA,GAEAC,UACA,qBACA,EACAC,iBAAAA,EAAAA,EAAAA,GACAC,EAAAA,KAAAA,IAAAA,OAAAA,QACAC,GACA,EACAC,QAAAA,CACA,uBACA,MAAAR,KAAAA,SAAA,0BACA,oDACA,gBACA,yBACA,kBAEA,YACA,EAEAjB,SACA,qBACA,ICzD4P,I,UCQxP0B,GAAY,OACd,EACAtC,EACAwB,GACA,EACA,KACA,WACA,MAIF,EAAec,EAAiB,O,4FChBzB,MAAMC,EAAoBP,IAC/B,MAAMH,EAAO,CAAEW,WAAY,CAAEC,MAAO,EAAGC,IAAK,GAAKC,KAAM,CAAEpB,OAAQ,GAAKqB,WAAY,YAClF,OAAOC,EAAAA,EAAAA,KAAa,eAAgBhB,GAAMiB,MAAKC,IAC7C,MAAMC,EAASD,EAAIlB,KAAKoB,UAAUC,QAAO7B,GAAQA,EAAKoB,MAAMU,cAAcC,SAASpB,EAAGmB,iBACtF,OAAOH,EAAOK,KAAIhC,GAAQA,EAAKoB,OAAM,GACrC,EAGSa,EAAqB,CAACtB,EAAIF,KACrC,MAAMD,EAAO,CAAE0B,KAAM,EAAW,GAAPzB,EAAW0B,MAAO,GAAIb,KAAM,CAAEpB,OAAQ,GAAKiB,WAAY,CAAEE,IAAK,GAAKE,WAAY,YACxG,OAAOC,EAAAA,EAAAA,KAAa,eAAgBhB,EAAK,C","sources":["webpack://toutiao/./src/views/SearchResult.vue","webpack://toutiao/src/views/SearchResult.vue","webpack://toutiao/./src/views/SearchResult.vue?d760","webpack://toutiao/./src/views/SearchResult.vue?69fc","webpack://toutiao/./src/api/SearchAPI.js"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"search-result-container\"},[_c('van-nav-bar',{attrs:{\"title\":\"搜索结果\",\"left-arrow\":\"\",\"fixed\":\"\"},on:{\"click-left\":function($event){return _vm.$router.back()}}}),_c('van-list',{attrs:{\"finished\":_vm.finished,\"finished-text\":\"没有更多了\",\"immediate-check\":false},on:{\"load\":_vm.onLoad},model:{value:(_vm.loading),callback:function ($$v) {_vm.loading=$$v},expression:\"loading\"}},_vm._l((_vm.searchList),function(item){return _c('art-item',{key:item.art_id,attrs:{\"article\":item,\"closeAble\":false}})}),1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"search-result-container\">\r\n    <van-nav-bar title=\"搜索结果\" left-arrow fixed @click-left=\"$router.back()\"></van-nav-bar>\r\n\r\n    <van-list v-model=\"loading\" :finished=\"finished\" finished-text=\"没有更多了\" :immediate-check=\"false\" @load=\"onLoad\">\r\n      <art-item v-for=\"item in searchList\" :key=\"item.art_id\" :article=\"item\" :closeAble=\"false\"></art-item>\r\n    </van-list>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { getSearchResultAPI } from '@/api/SearchAPI'\r\nimport ArtItem from '@/components/ArtItem/ArtItem.vue'\r\nexport default {\r\n  name: 'SearchResult',\r\n  components: {\r\n    ArtItem\r\n  },\r\n  props: ['kw'],\r\n  data() {\r\n    return {\r\n      searchList: [],\r\n      loading: false,\r\n      finished: false,\r\n      page: 0\r\n    }\r\n  },\r\n  watch: {\r\n    kw() {\r\n      // 1. 重置关键数据\r\n      this.page = 0\r\n      this.searchList = []\r\n      this.loading = false\r\n      this.finished = false\r\n      // 2. 请求数据\r\n      this.initSearchList()\r\n    }\r\n  },\r\n  created() {\r\n    this.initSearchList()\r\n  },\r\n  beforeRouteLeave(to, from, next) {\r\n    from.meta.top = window.scrollY\r\n    next()\r\n  },\r\n  methods: {\r\n    async initSearchList() {\r\n      const { data: res } = await getSearchResultAPI(this.kw, this.page)\r\n      this.searchList = [...this.searchList, ...res.documents]\r\n      this.loading = false\r\n      if (res.documents.length === 0) {\r\n        this.finished = true\r\n      }\r\n      this.page += 1\r\n    },\r\n\r\n    onLoad() {\r\n      this.initSearchList()\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.search-result-container {\r\n  padding-top: 46px;\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./SearchResult.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./SearchResult.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SearchResult.vue?vue&type=template&id=65644bca&scoped=true&\"\nimport script from \"./SearchResult.vue?vue&type=script&lang=js&\"\nexport * from \"./SearchResult.vue?vue&type=script&lang=js&\"\nimport style0 from \"./SearchResult.vue?vue&type=style&index=0&id=65644bca&prod&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"65644bca\",\n  null\n  \n)\n\nexport default component.exports","import request from '@/utils/request.js'\r\n\r\n// 获取所有文章,自己做筛选\r\nexport const getSuggestListAPI = kw => {\r\n  const data = { projection: { title: 1, _id: 0 }, sort: { art_id: 1 }, collection: 'articles' }\r\n  return request.post('/action/find', data).then(res => {\r\n    const newRes = res.data.documents.filter(item => item.title.toUpperCase().includes(kw.toUpperCase()))\r\n    return newRes.map(item => item.title)\r\n  })\r\n}\r\n\r\nexport const getSearchResultAPI = (kw, page) => {\r\n  const data = { skip: 0 + page * 10, limit: 10, sort: { art_id: 1 }, projection: { _id: 0 }, collection: 'articles' }\r\n  return request.post('/action/find', data)\r\n}\r\n"],"names":["render","_vm","this","_c","_self","staticClass","attrs","on","$event","$router","back","finished","onLoad","model","value","loading","callback","$$v","expression","_l","searchList","item","key","art_id","staticRenderFns","name","components","ArtItem","props","data","page","watch","kw","created","beforeRouteLeave","from","next","methods","component","getSuggestListAPI","projection","title","_id","sort","collection","request","then","res","newRes","documents","filter","toUpperCase","includes","map","getSearchResultAPI","skip","limit"],"sourceRoot":""}
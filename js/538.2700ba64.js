"use strict";(self["webpackChunktoutiao"]=self["webpackChunktoutiao"]||[]).push([[538],{538:function(e,t,a){a.r(t),a.d(t,{default:function(){return m}});var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"user-edit-container"},[t("van-nav-bar",{attrs:{title:"编辑资料","left-arrow":""},on:{"click-left":function(t){return e.$router.back()}}}),t("van-cell-group",{staticClass:"action-card"},[t("van-cell",{attrs:{title:"头像","is-link":"",center:""},scopedSlots:e._u([{key:"default",fn:function(){return[t("van-image",{staticClass:"avatar",attrs:{round:"",src:e.userProfile.photo},on:{click:function(t){return e.$refs.fileRef.click()}}}),t("input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"fileRef",attrs:{type:"file",accept:"image/*"},on:{change:e.onFileChange}})]},proxy:!0}])}),t("van-cell",{attrs:{title:"名称","is-link":"",value:e.userProfile.name},on:{click:e.onNameCellClick}}),t("van-cell",{attrs:{title:"生日","is-link":"",value:e.userProfile.birthday},on:{click:e.onBirthCellClick}})],1),t("van-dialog",{attrs:{title:"修改名称","show-cancel-button":"","before-close":e.beforeClose},model:{value:e.showNameDialog,callback:function(t){e.showNameDialog=t},expression:"showNameDialog"}},[t("van-field",{ref:"nameRef",attrs:{placeholder:"请输入用户名","input-align":"center",maxlength:"7"},model:{value:e.name,callback:function(t){e.name="string"===typeof t?t.trim():t},expression:"name"}})],1),t("van-dialog",{attrs:{showConfirmButton:!1},model:{value:e.showBirthdSheet,callback:function(t){e.showBirthdSheet=t},expression:"showBirthdSheet"}},[t("van-datetime-picker",{attrs:{type:"date",title:"选择出生日期","min-date":e.minDate,"max-date":e.maxDate},on:{cancel:function(t){e.showBirthdSheet=!1},confirm:e.updateBirthday},model:{value:e.currentDate,callback:function(t){e.currentDate=t},expression:"currentDate"}})],1)],1)},n=[],r=a(3822),s=a(5212),o=a(5743),l=a.n(o),c={name:"UserEdit",data(){return{showNameDialog:!1,name:"",showBirthdSheet:!1,minDate:new Date(1990,0,1),maxDate:new Date(2050,10,1),currentDate:new Date}},computed:{...(0,r.rn)(["userProfile"])},created(){this.initUserProfile()},methods:{...(0,r.nv)(["initUserProfile"]),onNameCellClick(){this.name=this.userProfile.name,this.showNameDialog=!0,this.$nextTick((()=>{this.$refs.nameRef.focus()}))},beforeClose(e,t){return"cancel"===e?t():""===this.name||this.name.length>7?(this.$notify({type:"warning",message:"名称的长度为1到7个字符",duration:2e3}),this.$refs.nameRef.focus(),t(!1)):void this.updateName(t)},async updateName(e){await(0,s.r0)({name:this.name}),e(),this.initUserProfile(),this.$notify({type:"success",message:"修改用户名成功",duration:2e3})},onBirthCellClick(){this.currentDate=this.userProfile.birthday?new Date(this.userProfile.birthday):new Date,this.showBirthdSheet=!0},async updateBirthday(e){this.showBirthdSheet=!1;const t=l()(e).format("YYYY-MM-DD");await(0,s.r0)({birthday:t}),this.initUserProfile(),this.$notify({type:"success",message:"修改生日成功",duration:1e3})},async onFileChange(e){const t=e.currentTarget.files;if(0===t.length)return;const a=new FormData;a.append("photo",t[0]),console.log(FormData),await(0,s.E5)(a)}}},h=c,u=a(1001),f=(0,u.Z)(h,i,n,!1,null,"337ec64b",null),m=f.exports}}]);
//# sourceMappingURL=538.2700ba64.js.map
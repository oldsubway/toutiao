"use strict";(self["webpackChunktoutiao"]=self["webpackChunktoutiao"]||[]).push([[963],{7963:function(t,s,e){e.r(s),e.d(s,{default:function(){return u}});var i=function(){var t=this,s=t._self._c;return s("div",{staticClass:"search-container"},[s("div",{staticClass:"search-header"},[s("van-icon",{staticClass:"goback",attrs:{name:"arrow-left",color:"white",size:"18"},on:{click:function(s){return t.$router.back()}}}),s("van-search",{attrs:{placeholder:"请输入搜索关键词",background:"#007BFF",shape:"round"},on:{input:t.onInput},model:{value:t.kw,callback:function(s){t.kw="string"===typeof s?s.trim():s},expression:"kw"}})],1),0!==t.kw.length?s("div",{staticClass:"sugg-list"},t._l(t.suggestList,(function(e,i){return s("div",{key:i,staticClass:"sugg-item",domProps:{innerHTML:t._s(e)},on:{click:t.gotoSearchResult}})})),0):s("div",{staticClass:"search-history"},[s("van-cell",{attrs:{title:"搜索历史"},scopedSlots:t._u([{key:"right-icon",fn:function(){return[s("van-icon",{staticClass:"delete-icon",attrs:{name:"delete"},on:{click:function(s){t.history=[]}}})]},proxy:!0}])}),s("div",{staticClass:"history-list"},t._l(t.history,(function(e,i){return s("div",{key:i,staticClass:"history-item",domProps:{innerHTML:t._s(e)},on:{click:t.gotoSearchResult}},[t._v(t._s(e))])})),0)],1)])},n=[],r=(e(541),e(7658),e(6653)),o={name:"SearchView",data(){return{kw:"",timer:null,suggestList:[],history:JSON.parse(localStorage.getItem("history")||"[]")}},watch:{history(t){localStorage.setItem("history",JSON.stringify(t))}},mounted(){const t=document.querySelector("input[type=search]");t&&t.focus()},methods:{onInput(){clearTimeout(this.timer),0!==this.kw.length?this.timer=setTimeout((()=>{this.initSuggestList()}),500):this.suggestList=[]},async initSuggestList(){const t=await(0,r.Y)(this.kw);if(0===t.length)return this.suggestList=[],this.$notify({message:"没有找到相关文章",type:"danger",duration:1e3});this.suggestList=t,this.highKeywords(this.suggestList);const s=this.history.filter((t=>t!==this.kw));s.unshift(this.kw),this.history=s},highKeywords(t){const s=new RegExp(this.kw,"ig");t.forEach(((e,i)=>{t[i]=e.replaceAll(s,(t=>`<span style='color:red;font-weight:bold;'>${t}</span>`))}))},gotoSearchResult(t){this.kw="";const s=t.currentTarget.innerText;this.$router.push("/search/"+s)}}},c=o,a=e(1001),l=(0,a.Z)(c,i,n,!1,null,"6df802ff",null),u=l.exports},6653:function(t,s,e){e.d(s,{S:function(){return r},Y:function(){return n}});var i=e(4471);const n=t=>{const s={projection:{title:1,_id:0},sort:{art_id:1},collection:"articles"};return i.Z.post("/action/find",s).then((s=>{const e=s.data.documents.filter((s=>s.title.toUpperCase().includes(t.toUpperCase())));return e.map((t=>t.title))}))},r=(t,s)=>{const e={skip:0+10*s,limit:10,sort:{art_id:1},projection:{_id:0},collection:"articles"};return i.Z.post("/action/find",e)}}}]);
//# sourceMappingURL=963.6f55356d.js.map